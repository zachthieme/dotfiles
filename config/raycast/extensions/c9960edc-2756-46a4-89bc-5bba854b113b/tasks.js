"use strict";var Lt=Object.create;var tt=Object.defineProperty;var Yt=Object.getOwnPropertyDescriptor;var Pt=Object.getOwnPropertyNames;var Ht=Object.getPrototypeOf,Wt=Object.prototype.hasOwnProperty;var I=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),It=(t,e)=>{for(var a in e)tt(t,a,{get:e[a],enumerable:!0})},dt=(t,e,a,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Pt(e))!Wt.call(t,n)&&n!==a&&tt(t,n,{get:()=>e[n],enumerable:!(r=Yt(e,n))||r.enumerable});return t};var J=(t,e,a)=>(a=t!=null?Lt(Ht(t)):{},dt(e||!t||!t.__esModule?tt(a,"default",{value:t,enumerable:!0}):a,t)),Jt=t=>dt(tt({},"__esModule",{value:!0}),t);var lt=I((et,ft)=>{(function(t,e){typeof et=="object"&&typeof ft<"u"?e(et):typeof define=="function"&&define.amd?define(["exports"],e):e((t||self).logseqDateutils={})})(et,function(t){var e=function(r){return r+(r>0?["th","st","nd","rd"][r>3&&r<21||r%10>3?0:r%10]:"")},a=function(r){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][r.getDay()]};t.getDateForPage=function(r,n){var h=r.getFullYear(),M=r.toString().substring(4,7),l=r.getMonth()+1,$=r.getDate(),D=r.toLocaleString("default",{month:"long"});if(n==="MMM do yyyy")return"[["+M+" "+e($)+", "+h+"]]";if(n.includes("yyyy")&&(n.includes("MM")||n.includes("MMM"))&&n.includes("dd")&&(n.includes("EEEE")||n.includes("EEE")||n.includes("E"))){var T=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],F={yyyy:h,dd:("0"+$).slice(-2),MM:("0"+l).slice(-2),MMMM:D,EEEE:T[r.getDay()],EEE:T[r.getDay()].substring(0,3),E:T[r.getDay()].substring(0,1)};return"[["+n.replace(/yyyy|dd|MM|EEEE|EEE|E/gi,function(N){return F[N]})+"]]"}if(n==="do MMMM yyyy"||n==="MMMM do, yyyy"){var x={yyyy:h,do:e($),MMMM:D};return"[["+n.replace(/yyyy|do|MMMM/gi,function(N){return x[N]})+"]]"}if(n.includes("yyyy")&&n.includes("MM")&&n.includes("dd")){var H={yyyy:h,dd:("0"+$).slice(-2),MM:("0"+l).slice(-2)};return"[["+n.replace(/yyyy|dd|MM/gi,function(N){return H[N]})+"]]"}return"[["+M+" "+e($)+", "+h+"]]"},t.getDateForPageWithoutBrackets=function(r,n){var h=r.getFullYear(),M=r.toString().substring(4,7),l=r.getMonth()+1,$=r.getDate(),D=r.toLocaleString("default",{month:"long"});if(n==="MMM do yyyy")return M+" "+e($)+", "+h;if(n.includes("yyyy")&&n.includes("MM")&&n.includes("dd")&&(n.includes("EEEE")||n.includes("EEE")||n.includes("E"))){var T=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],F={yyyy:h,dd:("0"+$).slice(-2),MM:("0"+l).slice(-2),EEEE:T[r.getDay()],EEE:T[r.getDay()].substring(0,3),E:T[r.getDay()].substring(0,1)};return""+n.replace(/yyyy|dd|MM|EEEE|EEE|E/gi,function(N){return F[N]})}if(n==="do MMMM yyyy"||n==="MMMM do, yyyy"){var x={yyyy:h,do:e($),MMMM:D};return""+n.replace(/yyyy|do|MMMM/gi,function(N){return x[N]})}if(n.includes("yyyy")&&n.includes("MM")&&n.includes("dd")){var H={yyyy:h,dd:("0"+$).slice(-2),MM:("0"+l).slice(-2)};return""+n.replace(/yyyy|dd|MM/gi,function(N){return H[N]})}return n==="MMMM do, yyyy"?r.toLocaleString("default",{month:"long"})+" "+e($)+", "+h:n==="do MMM yyyy"?e($)+" "+M+" "+h:M+" "+e($)+", "+h},t.getDayInText=a,t.getScheduledDeadlineDateDay=function(r){return r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()+" "+a(r).substring(0,3)},t.getScheduledDeadlineDateDayTime=function(r){return r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()+" "+a(r).substring(0,3)+" "+r.toTimeString().substring(0,5)},t.getYYMMDDTHHMMFormat=function(r){return[r.getFullYear(),("0"+(r.getMonth()+1)).slice(-2),("0"+r.getDate()).slice(-2)].join("-")+"T"+r.toTimeString().substring(0,5)},t.getYYYMMDD=function(r){return[r.getFullYear(),("0"+(r.getMonth()+1)).slice(-2),("0"+r.getDate()).slice(-2)].join("")}})});var gt=I(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.parseEDNString=U.EDNListParser=void 0;var A;(function(t){t[t.idle=0]="idle",t[t.string=1]="string",t[t.escape=2]="escape",t[t.comment=3]="comment"})(A||(A={}));var O;(function(t){t[t.vector=0]="vector",t[t.list=1]="list",t[t.map=2]="map",t[t.set=3]="set",t[t.tag=4]="tag"})(O||(O={}));var Ut={t:"	",r:"\r",n:`
`,"\\":"\\",'"':'"'},qt=[","," ","	",`
`,"\r"],Vt=/^[-+]?(0|[1-9][0-9]*)$/,Rt=/^[-+]?(0|[1-9][0-9]*)(\.[0-9]+)?([eE][+-]?(0|[1-9][0-9]*))?M?$/,Gt={inst:t=>{if(typeof t!="string")throw new Error("#inst value must be a string");return new Date(t)}},rt=class{constructor({mapAs:e="doubleArray",setAs:a="object",keywordAs:r="object",charAs:n="object",listAs:h="object",tagHandlers:M={}}={}){this.stack=[],this.mode=A.idle,this.state="",this.started=!1,this.done=!1,this.mapAs=e,this.setAs=a,this.keywordAs=r,this.charAs=n,this.listAs=h,this.tagHandlers={...Gt,...M}}updateStack(){if(this.stack.length===0||this.result===void 0)return;let[e,a]=this.stack[this.stack.length-1];if(e===O.vector)a.push(this.result);else if(e===O.list)a.push(this.result);else if(e===O.set)a.push(this.result);else if(e===O.map)a[1].length>0?a[0].push([a[1].pop(),this.result]):a[1].push(this.result);else if(e===O.tag){if(this.stack.pop(),a==="_")this.result=void 0;else{let r=this.tagHandlers[a];r?this.result=r(this.result):this.result={tag:a,val:this.result}}this.updateStack();return}this.result=void 0}match(){if(this.state==="nil")this.result=null;else if(this.state==="true")this.result=!0;else if(this.state==="false")this.result=!1;else if(this.state[0]===":")this.result=this.keywordAs==="string"?this.state.substr(1):{key:this.state.substr(1)};else if(this.state[0]==="#")this.stack.push([O.tag,this.state.substr(1)]),this.result=void 0;else if(Vt.test(this.state))this.result=parseInt(this.state,10);else if(Rt.test(this.state))this.result=parseFloat(this.state);else if(this.state[0]==="\\"){let e;this.state==="\\space"?e=" ":this.state==="\\newline"?e=`
`:this.state==="\\return"?e="\r":this.state==="\\tab"?e="	":this.state==="\\\\"?e="\\":e=this.state.substr(1),this.charAs==="string"?this.result=e:this.result={char:e}}else this.state!==""&&(this.result={sym:this.state});this.state=""}next(e){let a=[];for(let r=0;r<e.length;r++){this.stack.length===0&&this.result!==void 0&&(a.push(this.result),this.result=void 0);let n=e[r];if(this.mode===A.idle){if(n==='"'){this.match(),this.updateStack(),this.mode=A.string,this.state="";continue}if(n===";"){this.mode=A.comment;continue}if(qt.includes(n)){this.match(),this.updateStack();continue}if(n==="}"){if(this.match(),this.updateStack(),this.stack.length!==0){let[M,l]=this.stack.pop();M===O.map?this.mapAs==="object"?this.result=l[0].reduce(($,[D,T])=>({...$,[D]:T}),{}):this.mapAs==="map"?this.result=new Map(l[0]):this.result={map:l[0]}:this.setAs==="array"?this.result=l:this.setAs==="set"?this.result=new Set(l):this.result={set:l}}this.updateStack();continue}if(n==="]"){this.match(),this.updateStack();let[M,l]=this.stack.pop();this.result=l,this.updateStack();continue}if(n===")"){if(this.match(),this.updateStack(),this.stack.length===0)return this.result!==void 0&&a.push(this.result),this.done=!0,a;let[M,l]=this.stack.pop();this.listAs==="array"?this.result=l:this.result={list:l},this.updateStack();continue}if(n==="["){this.match(),this.updateStack(),this.stack.push([O.vector,[]]);continue}else if(n==="("){if(!this.started){this.started=!0;continue}this.match(),this.updateStack(),this.stack.push([O.list,[]]);continue}let h=this.state+n;if(h==="#_"){this.stack.push([O.tag,n]),this.result=void 0,this.state="";continue}if(h.endsWith("#{")){this.state=this.state.slice(0,-1),this.match(),this.updateStack(),this.stack.push([O.set,[]]),this.state="";continue}if(n==="{"){this.match(),this.updateStack(),this.stack.push([O.map,[[],[]]]),this.state="";continue}this.state+=n;continue}else if(this.mode===A.string){if(n==="\\"){this.stack.push([this.mode,this.state]),this.mode=A.escape,this.state="";continue}if(n==='"'){this.mode=A.idle,this.result=this.state,this.updateStack(),this.state="";continue}this.state+=n}else if(this.mode===A.escape){let h=Ut[n],[M,l]=this.stack.pop();this.mode=M,this.state=l+h}else this.mode===A.comment&&n===`
`&&(this.mode=A.idle)}return a}isDone(){return this.done}};U.EDNListParser=rt;U.parseEDNString=(t,e)=>{let a=new rt(e),[r]=a.next("("+t+")");return r===void 0?null:r}});var pt=I(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.toEDNStringFromSimpleObject=y.toEDNString=y.toSymbol=y.toKeyword=y.tagValue=void 0;var Kt=t=>t.key!==void 0,Zt=t=>t.sym!==void 0,zt=t=>t.map!==void 0,Bt=t=>t.set!==void 0,Qt=t=>t.list!==void 0,Xt=t=>t.tag!==void 0,te=t=>t.char!==void 0;y.tagValue=(t,e)=>({tag:t,val:e});y.toKeyword=t=>({key:t});y.toSymbol=t=>({sym:t});y.toEDNString=t=>{if(typeof t=="string")return JSON.stringify(t);if(Array.isArray(t))return`[${t.map(y.toEDNString).join(" ")}]`;if(typeof t=="number")return t.toString();if(typeof t=="boolean")return JSON.stringify(t);if(t===null)return"nil";if(t instanceof Date)return`#inst "${t.toISOString()}"`;if(typeof t=="bigint")return`${t}N`;if(t instanceof Map)return`{${[...t].map(([e,a])=>`${y.toEDNString(e)} ${y.toEDNString(a)}`).join(" ")}}`;if(t instanceof Set)return`#{${[...t].map(y.toEDNString).join(" ")}}`;if(zt(t))return`{${t.map.map(([e,a])=>`${y.toEDNString(e)} ${y.toEDNString(a)}`).join(" ")}}`;if(Bt(t))return`#{${t.set.map(y.toEDNString).join(" ")}}`;if(Kt(t))return`:${t.key}`;if(Zt(t))return t.sym;if(Qt(t))return`(${t.list.map(y.toEDNString).join(" ")})`;if(Xt(t))return`#${t.tag} ${y.toEDNString(t.val)}`;if(te(t))return`\\${t.char}`;throw new TypeError(`Unknown type: ${JSON.stringify(t)}`)};y.toEDNStringFromSimpleObject=(t,e={keysAs:"keyword"})=>{if(typeof t=="string")return JSON.stringify(t);if(Array.isArray(t))return`[${t.map(a=>y.toEDNStringFromSimpleObject(a,e)).join(" ")}]`;if(typeof t=="number")return t.toString();if(typeof t=="boolean")return JSON.stringify(t);if(t===null)return"nil";if(t instanceof Date)return`#inst "${t.toISOString()}"`;if(typeof t=="bigint")return`${t}N`;if(t instanceof Map)return`{${[...t].map(([a,r])=>`${y.toEDNStringFromSimpleObject(a,e)} ${y.toEDNStringFromSimpleObject(r,e)}`).join(" ")}}`;if(t instanceof Set)return`#{${[...t].map(a=>y.toEDNStringFromSimpleObject(a,e)).join(" ")}}`;if(typeof t=="object")return`{${Object.entries(t).map(([a,r])=>`${e.keysAs==="string"?JSON.stringify(a):`:${a}`} ${y.toEDNStringFromSimpleObject(r,e)}`).join(" ")}}`;throw new TypeError(`Unknown type: ${JSON.stringify(t)}`)}});var yt=I(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});var ee=gt();Object.defineProperty(C,"parseEDNString",{enumerable:!0,get:function(){return ee.parseEDNString}});var Z=pt();Object.defineProperty(C,"toEDNString",{enumerable:!0,get:function(){return Z.toEDNString}});Object.defineProperty(C,"toEDNStringFromSimpleObject",{enumerable:!0,get:function(){return Z.toEDNStringFromSimpleObject}});Object.defineProperty(C,"tagValue",{enumerable:!0,get:function(){return Z.tagValue}});Object.defineProperty(C,"toKeyword",{enumerable:!0,get:function(){return Z.toKeyword}});Object.defineProperty(C,"toSymbol",{enumerable:!0,get:function(){return Z.toSymbol}})});var mt=I((ot,at)=>{(function(t,e){typeof ot=="object"&&typeof at<"u"?at.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self).dayjs=e()})(ot,function(){"use strict";var t=1e3,e=6e4,a=36e5,r="millisecond",n="second",h="minute",M="hour",l="day",$="week",D="month",T="quarter",F="year",x="date",H="Invalid Date",N=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,vt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_t={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(c){var o=["th","st","nd","rd"],s=c%100;return"["+c+(o[(s-20)%10]||o[s]||o[0])+"]"}},st=function(c,o,s){var u=String(c);return!u||u.length>=o?c:""+Array(o+1-u.length).join(s)+c},Ct={s:st,z:function(c){var o=-c.utcOffset(),s=Math.abs(o),u=Math.floor(s/60),i=s%60;return(o<=0?"+":"-")+st(u,2,"0")+":"+st(i,2,"0")},m:function c(o,s){if(o.date()<s.date())return-c(s,o);var u=12*(s.year()-o.year())+(s.month()-o.month()),i=o.clone().add(u,D),d=s-i<0,f=o.clone().add(u+(d?-1:1),D);return+(-(u+(s-i)/(d?i-f:f-i))||0)},a:function(c){return c<0?Math.ceil(c)||0:Math.floor(c)},p:function(c){return{M:D,y:F,w:$,d:l,D:x,h:M,m:h,s:n,ms:r,Q:T}[c]||String(c||"").toLowerCase().replace(/s$/,"")},u:function(c){return c===void 0}},R="en",L={};L[R]=_t;var ct="$isDayjsObject",it=function(c){return c instanceof Q||!(!c||!c[ct])},B=function c(o,s,u){var i;if(!o)return R;if(typeof o=="string"){var d=o.toLowerCase();L[d]&&(i=d),s&&(L[d]=s,i=d);var f=o.split("-");if(!i&&f.length>1)return c(f[0])}else{var p=o.name;L[p]=o,i=p}return!u&&i&&(R=i),i||!u&&R},E=function(c,o){if(it(c))return c.clone();var s=typeof o=="object"?o:{};return s.date=c,s.args=arguments,new Q(s)},g=Ct;g.l=B,g.i=it,g.w=function(c,o){return E(c,{locale:o.$L,utc:o.$u,x:o.$x,$offset:o.$offset})};var Q=function(){function c(s){this.$L=B(s.locale,null,!0),this.parse(s),this.$x=this.$x||s.x||{},this[ct]=!0}var o=c.prototype;return o.parse=function(s){this.$d=function(u){var i=u.date,d=u.utc;if(i===null)return new Date(NaN);if(g.u(i))return new Date;if(i instanceof Date)return new Date(i);if(typeof i=="string"&&!/Z$/i.test(i)){var f=i.match(N);if(f){var p=f[2]-1||0,S=(f[7]||"0").substring(0,3);return d?new Date(Date.UTC(f[1],p,f[3]||1,f[4]||0,f[5]||0,f[6]||0,S)):new Date(f[1],p,f[3]||1,f[4]||0,f[5]||0,f[6]||0,S)}}return new Date(i)}(s),this.init()},o.init=function(){var s=this.$d;this.$y=s.getFullYear(),this.$M=s.getMonth(),this.$D=s.getDate(),this.$W=s.getDay(),this.$H=s.getHours(),this.$m=s.getMinutes(),this.$s=s.getSeconds(),this.$ms=s.getMilliseconds()},o.$utils=function(){return g},o.isValid=function(){return this.$d.toString()!==H},o.isSame=function(s,u){var i=E(s);return this.startOf(u)<=i&&i<=this.endOf(u)},o.isAfter=function(s,u){return E(s)<this.startOf(u)},o.isBefore=function(s,u){return this.endOf(u)<E(s)},o.$g=function(s,u,i){return g.u(s)?this[u]:this.set(i,s)},o.unix=function(){return Math.floor(this.valueOf()/1e3)},o.valueOf=function(){return this.$d.getTime()},o.startOf=function(s,u){var i=this,d=!!g.u(u)||u,f=g.p(s),p=function(P,k){var _=g.w(i.$u?Date.UTC(i.$y,k,P):new Date(i.$y,k,P),i);return d?_:_.endOf(l)},S=function(P,k){return g.w(i.toDate()[P].apply(i.toDate("s"),(d?[0,0,0,0]:[23,59,59,999]).slice(k)),i)},b=this.$W,w=this.$M,j=this.$D,W="set"+(this.$u?"UTC":"");switch(f){case F:return d?p(1,0):p(31,11);case D:return d?p(1,w):p(0,w+1);case $:var Y=this.$locale().weekStart||0,G=(b<Y?b+7:b)-Y;return p(d?j-G:j+(6-G),w);case l:case x:return S(W+"Hours",0);case M:return S(W+"Minutes",1);case h:return S(W+"Seconds",2);case n:return S(W+"Milliseconds",3);default:return this.clone()}},o.endOf=function(s){return this.startOf(s,!1)},o.$set=function(s,u){var i,d=g.p(s),f="set"+(this.$u?"UTC":""),p=(i={},i[l]=f+"Date",i[x]=f+"Date",i[D]=f+"Month",i[F]=f+"FullYear",i[M]=f+"Hours",i[h]=f+"Minutes",i[n]=f+"Seconds",i[r]=f+"Milliseconds",i)[d],S=d===l?this.$D+(u-this.$W):u;if(d===D||d===F){var b=this.clone().set(x,1);b.$d[p](S),b.init(),this.$d=b.set(x,Math.min(this.$D,b.daysInMonth())).$d}else p&&this.$d[p](S);return this.init(),this},o.set=function(s,u){return this.clone().$set(s,u)},o.get=function(s){return this[g.p(s)]()},o.add=function(s,u){var i,d=this;s=Number(s);var f=g.p(u),p=function(w){var j=E(d);return g.w(j.date(j.date()+Math.round(w*s)),d)};if(f===D)return this.set(D,this.$M+s);if(f===F)return this.set(F,this.$y+s);if(f===l)return p(1);if(f===$)return p(7);var S=(i={},i[h]=e,i[M]=a,i[n]=t,i)[f]||1,b=this.$d.getTime()+s*S;return g.w(b,this)},o.subtract=function(s,u){return this.add(-1*s,u)},o.format=function(s){var u=this,i=this.$locale();if(!this.isValid())return i.invalidDate||H;var d=s||"YYYY-MM-DDTHH:mm:ssZ",f=g.z(this),p=this.$H,S=this.$m,b=this.$M,w=i.weekdays,j=i.months,W=i.meridiem,Y=function(k,_,K,X){return k&&(k[_]||k(u,d))||K[_].slice(0,X)},G=function(k){return g.s(p%12||12,k,"0")},P=W||function(k,_,K){var X=k<12?"AM":"PM";return K?X.toLowerCase():X};return d.replace(vt,function(k,_){return _||function(K){switch(K){case"YY":return String(u.$y).slice(-2);case"YYYY":return g.s(u.$y,4,"0");case"M":return b+1;case"MM":return g.s(b+1,2,"0");case"MMM":return Y(i.monthsShort,b,j,3);case"MMMM":return Y(j,b);case"D":return u.$D;case"DD":return g.s(u.$D,2,"0");case"d":return String(u.$W);case"dd":return Y(i.weekdaysMin,u.$W,w,2);case"ddd":return Y(i.weekdaysShort,u.$W,w,3);case"dddd":return w[u.$W];case"H":return String(p);case"HH":return g.s(p,2,"0");case"h":return G(1);case"hh":return G(2);case"a":return P(p,S,!0);case"A":return P(p,S,!1);case"m":return String(S);case"mm":return g.s(S,2,"0");case"s":return String(u.$s);case"ss":return g.s(u.$s,2,"0");case"SSS":return g.s(u.$ms,3,"0");case"Z":return f}return null}(k)||f.replace(":","")})},o.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},o.diff=function(s,u,i){var d,f=this,p=g.p(u),S=E(s),b=(S.utcOffset()-this.utcOffset())*e,w=this-S,j=function(){return g.m(f,S)};switch(p){case F:d=j()/12;break;case D:d=j();break;case T:d=j()/3;break;case $:d=(w-b)/6048e5;break;case l:d=(w-b)/864e5;break;case M:d=w/a;break;case h:d=w/e;break;case n:d=w/t;break;default:d=w}return i?d:g.a(d)},o.daysInMonth=function(){return this.endOf(D).$D},o.$locale=function(){return L[this.$L]},o.locale=function(s,u){if(!s)return this.$L;var i=this.clone(),d=B(s,u,!0);return d&&(i.$L=d),i},o.clone=function(){return g.w(this.$d,this)},o.toDate=function(){return new Date(this.valueOf())},o.toJSON=function(){return this.isValid()?this.toISOString():null},o.toISOString=function(){return this.$d.toISOString()},o.toString=function(){return this.$d.toUTCString()},c}(),ht=Q.prototype;return E.prototype=ht,[["$ms",r],["$s",n],["$m",h],["$H",M],["$W",l],["$M",D],["$y",F],["$D",x]].forEach(function(c){ht[c[1]]=function(o){return this.$g(o,c[0],c[1])}}),E.extend=function(c,o){return c.$i||(c(o,Q,E),c.$i=!0),E},E.locale=B,E.isDayjs=it,E.unix=function(c){return E(1e3*c)},E.en=L[R],E.Ls=L,E.p={},E})});var $t=I((pe,St)=>{"use strict";var re=require("os"),Mt=re.homedir();St.exports=t=>{if(typeof t!="string")throw new TypeError(`Expected a string, got ${typeof t}`);return Mt?t.replace(/^~(?=$|\/|\\)/,Mt):t}});var he={};It(he,{default:()=>xt});module.exports=Jt(he);var m=require("@raycast/api"),z=require("react");var V=require("@raycast/api"),Dt=J(lt()),Et=J(yt()),nt=J(require("path")),ne=J(mt()),q=J(require("fs")),bt=J($t()),wt=()=>{};var se=(t,e)=>`
${t.split(`
`).map(r=>{let n=r.match(/^( *)/)?.[0].length||0;return e?`${"*".repeat(n+1)} ${r.trimStart()}`:`${" ".repeat(n)}- ${r.trimStart()}`}).join(`
`)}`,kt=t=>q.default.promises.lstat(t).then(e=>{if(!e.isDirectory())throw`Folder does not exist: ${t}`}).catch(e=>{throw e.code==="ENOENT"?`Folder does not exist: ${t}`:"Error"}),ut=()=>(0,bt.default)((0,V.getPreferenceValues)().graphPath),Ot=()=>kt(ut()),Nt=()=>{let t=nt.default.join(ut(),"/logseq/config.edn");return q.default.promises.readFile(t,{encoding:"utf8"}).then(e=>(0,Et.parseEDNString)(e.toString(),{mapAs:"object",keywordAs:"string"}))};var ie=()=>Nt().then(t=>({fileFormat:t["preferred-format"]==="org"?".org":".md",journalsDirectory:t["journals-directory"]||"journals",dateFormat:t["journal/file-name-format"]||"yyyy_MM_dd"})),oe=t=>ie().then(({dateFormat:e,journalsDirectory:a,fileFormat:r})=>nt.default.join(t,a,`${(0,Dt.getDateForPageWithoutBrackets)(new Date,e)}${r}`)),Tt=async()=>await Nt().then(t=>t["preferred-workflow"]),Ft=()=>oe(ut()),ae=t=>q.default.promises.access(t).catch(e=>{if(e.code==="ENOENT")return q.default.promises.writeFile(t,"");throw e}),jt=()=>{(0,V.showToast)({style:V.Toast.Style.Failure,title:"Logseq graph path is invalid",message:"Update the path and try again."})},At=(t,e)=>{let a=e.endsWith(".org");return kt(nt.default.dirname(e)).then(()=>ae(e)).then(()=>q.default.promises.appendFile(e,se(t,a)))};var v=require("react/jsx-runtime"),ue=()=>{let[t,e]=(0,z.useState)([]),[a,r]=(0,z.useState)(!0);return(0,z.useEffect)(()=>{(async()=>{await Tt()=="todo"?e([{title:"Todo",value:"TODO"},{title:"Doing",value:"DOING"}]):e([{title:"Now",value:"NOW"},{title:"Later",value:"LATER"}]),r(!1)})()},[]),[t,a]};function ce(){let t=(0,m.getPreferenceValues)().taskScopes;return t?t.split(","):[]}function xt(){let{pop:t}=(0,m.useNavigation)(),[e,a]=ue(),r=ce();async function n(h){if(!h.task)return(0,m.showToast)({style:m.Toast.Style.Failure,title:"\u{1F41D} Type something to get started"}),!1;let M=`${h.when} ${h.task}`;return h.scope&&(M+=` #${h.scope}`),Ot().catch(l=>{throw jt(),l}).then(()=>(0,m.showToast)({style:m.Toast.Style.Animated,title:"Adding task"})).then(Ft).then(l=>At(M,l)).then(()=>(0,m.showHUD)("\u2705 Task added")).then(t).catch(l=>(0,m.showToast)({style:m.Toast.Style.Failure,title:"Failed",message:l})).catch(wt),!0}return(0,v.jsxs)(m.Form,{isLoading:a,actions:(0,v.jsx)(m.ActionPanel,{children:(0,v.jsx)(m.Action.SubmitForm,{title:"Add task",onSubmit:n})}),children:[(0,v.jsx)(m.Form.TextField,{id:"task",title:"Task",placeholder:"Enter your task"}),(0,v.jsx)(m.Form.Dropdown,{id:"when",title:"When",children:e.map(h=>(0,v.jsx)(m.Form.Dropdown.Item,{value:h.value,title:h.title},h.value))}),r.length&&(0,v.jsx)(m.Form.Dropdown,{id:"scope",title:"Scope",children:r.map(h=>(0,v.jsx)(m.Form.Dropdown.Item,{value:h,title:h},h))})]})}
